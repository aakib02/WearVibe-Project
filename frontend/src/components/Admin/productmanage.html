<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <title>Product Management</title>
</head>

<body class="font-sans bg-gray-50">


    <div id="webcrumbs" class="w-full min-h-screen p-6">
        <div class="max-w-7xl mx-auto space-y-6">
            <div class="bg-white rounded-xl shadow-sm p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-semibold">Product Management</h2>
                    <div class="flex space-x-3">
                        <button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                            <span class="material-symbols-outlined align-middle mr-2">add</span>
                            Add Product
                        </button>
                        <button class="px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                            <span class="material-symbols-outlined align-middle mr-2">upload_file</span>
                            Bulk Upload
                        </button>
                    </div>
                </div>

                <div class="mb-6">
                    <div class="flex space-x-4">
                        <div class="flex-1">
                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 pl-3 flex items-center">
                                    <span class="material-symbols-outlined text-gray-400">search</span>
                                </span>
                                <input type="text" placeholder="Search products..."
                                    class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" />
                            </div>
                        </div>
                        <details class="relative">
                            <summary
                                class="list-none cursor-pointer px-4 py-2 bg-white border rounded-lg hover:bg-gray-50">
                                <span class="material-symbols-outlined align-middle mr-2">filter_list</span>
                                Filters
                            </summary>
                            <div class="absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg p-4 z-10 border">
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-1">Category</label>
                                        <select class="w-full border rounded-lg p-2">
                                            <option>All Categories</option>
                                            <option>Electronics</option>
                                            <option>Clothing</option>
                                            <option>Accessories</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-1">Price Range</label>
                                        <div class="flex space-x-2">
                                            <input type="number" placeholder="Min"
                                                class="w-1/2 border rounded-lg p-2" />
                                            <input type="number" placeholder="Max"
                                                class="w-1/2 border rounded-lg p-2" />
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-1">Stock Status</label>
                                        <select class="w-full border rounded-lg p-2">
                                            <option>All</option>
                                            <option>In Stock</option>
                                            <option>Low Stock</option>
                                            <option>Out of Stock</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </details>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left">Product</th>
                                <th class="px-4 py-3 text-left">Category</th>
                                <th class="px-4 py-3 text-left">Stock</th>
                                <th class="px-4 py-3 text-right">Price</th>
                                <th class="px-4 py-3 text-center">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="hover:bg-gray-50">
                                <td class="px-4 py-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-12 h-12 bg-gray-100 rounded-lg"></div>
                                        <div>
                                            <p class="font-medium">Product Name</p>
                                            <p class="text-sm text-gray-500">SKU: PRD-001</p>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-4 py-3">Electronics</td>
                                <td class="px-4 py-3">
                                    <span class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                                        In Stock (24)
                                    </span>
                                </td>
                                <td class="px-4 py-3 text-right">$299.99</td>
                                <td class="px-4 py-3">
                                    <div class="flex justify-center space-x-2">

                                        <button class="p-2 hover:bg-gray-100 rounded-lg">
                                            <span class="material-symbols-outlined">edit</span>
                                        </button>
                                        <button class="p-2 hover:bg-gray-100 rounded-lg text-red-500">
                                            <span class="material-symbols-outlined">delete</span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-6 flex justify-between items-center">
                    <p class="text-sm text-gray-500">Showing 1 to 10 of 100 entries</p>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 border rounded-lg hover:bg-gray-50">Previous</button>
                        <button class="px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600">1</button>
                        <button class="px-3 py-1 border rounded-lg hover:bg-gray-50">2</button>
                        <button class="px-3 py-1 border rounded-lg hover:bg-gray-50">3</button>
                        <button class="px-3 py-1 border rounded-lg hover:bg-gray-50">Next</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Edit Modal -->
        <div id="editModal" class="hidden fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center">
            <div class="bg-white p-6 rounded-lg shadow-lg w-96 h-96 overflow-y-auto overflow-hidden" style="height: 40rem;">
                <h2 class="text-xl font-semibold mb-4">Edit Product</h2>
                <form id="editForm">
                    <input type="hidden" id="editProductId">
        
                    <label class="block mb-2">Product Name:</label>
                    <input type="text" id="editProductName" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Description:</label>
                    <textarea id="editDescription" class="w-full p-2 border rounded mb-3"></textarea>
        
                    <label class="block mb-2">Category:</label>
                    <input type="text" id="editCategory" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Brand:</label>
                    <input type="text" id="editBrand" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Price:</label>
                    <input type="number" id="editPrice" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Discount (%):</label>
                    <input type="number" id="editDiscount" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Final Price:</label>
                    <input type="number" id="editFinalPrice" class="w-full p-2 border rounded mb-3" readonly>
        
                    <label class="block mb-2">Stock:</label>
                    <input type="number" id="editStock" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Size:</label>
                    <select id="editSize" class="w-full p-2 border rounded mb-3">
                        <option value="">Select Size</option>
                        <option value="S">S</option>
                        <option value="M">M</option>
                        <option value="L">L</option>
                        <option value="XL">XL</option>
                        <option value="XXL">XXL</option>
                    </select>
        
                    <label class="block mb-2">Colors (comma-separated):</label>
                    <input type="text" id="editColors" class="w-full p-2 border rounded mb-3">
        
                    <label class="block mb-2">Upload Images:</label>
                    <input type="file" id="editImages" multiple class="w-full p-2 border rounded mb-3">
        
                    <div id="editPreview" class="grid grid-cols-3 gap-2 mt-2"></div>
        
                    <div class="flex justify-end space-x-2">
                        <button type="button" class="px-4 py-2 bg-gray-400 text-white rounded" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded">Update</button>
                    </div>
                </form>
            </div>
        </div>
        

    </div>
<!-- 
    <script>


        const getCookie = (name) => {
            const cookies = document.cookie.split("; ");
            for (let cookie of cookies) {
                const [cookieName, cookieValue] = cookie.split("=");
                if (cookieName === name) return cookieValue;
            }
            return null;
        };
        document.addEventListener("DOMContentLoaded", () => {
            const token = getCookie("token");  // ðŸª Token from cookies


            if (!token) {
                alert("You need to login first!");
                return;
            }

            fetch("http://localhost:3000/api/getVendorProduct", {
                method: "GET",
                headers: {
                    "Authorization": `Bearer ${token}`,
                    "Content-Type": "application/json",
                }
            })
                .then(response => response.json())
                .then(products => {
                    populateTable(products),
                        console.log(products);
                })
                .catch(error => console.error("Error fetching products:", error));
        });

        function deleteProduct(productId) {
            console.log(productId);
            const token = getCookie("token"); // ðŸª Token from cookies

            if (!token) {
                alert("You need to login first!");
                return;
            }

            if (!confirm("Are you sure you want to delete this product?")) return;

            fetch(`http://localhost:3000/api/deleteVendorProduct/${productId}`, {
                method: "DELETE",
                headers: {
                    "Authorization": `Bearer ${token}`,
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    alert(data.message);
                    location.reload(); // ðŸ”„ Page reload karega taaki deleted product list se hat jaye
                })
                .catch(error => console.error("Error deleting product:", error));
        }

        let selectedProductId = null;

function openEditModal(product) {
    selectedProductId = product._id; // Save product ID

    document.getElementById("editProductName").value = product.productName;
    document.getElementById("editCategory").value = product.category;
    document.getElementById("editPrice").value = product.price;
    document.getElementById("editStock").value = product.stock;

    document.getElementById("editModal").classList.remove("hidden"); // Modal show karein
}

function closeEditModal() {
    document.getElementById("editModal").classList.add("hidden"); // Modal hide karein
}

function updateProduct() {
    const token = getCookie("token");
    if (!token) {
        alert("You need to login first!");
        return;
    }

    const updatedProduct = {
        productName: document.getElementById("editProductName").value,
        category: document.getElementById("editCategory").value,
        price: document.getElementById("editPrice").value,
        stock: document.getElementById("editStock").value,
    };

    fetch(`http://localhost:3000/api/editVendorProduct/${selectedProductId}`, {
        method: "PUT",
        headers: {
            "Authorization": `Bearer ${token}`,
            "Content-Type": "application/json"
        },
        body: JSON.stringify(updatedProduct)
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        closeEditModal();
        location.reload(); // Refresh products
    })
    .catch(error => console.error("Error updating product:", error));
}



        function populateTable(products) {
            const tbody = document.querySelector("tbody"); // Table body select karo
            tbody.innerHTML = ""; // Purane rows hatao

            if (products.length === 0) {
                tbody.innerHTML = `<tr><td colspan="5" class="text-center text-gray-500 py-4">No products found.</td></tr>`;
                return;
            }

            products.forEach(product => {
                const row = document.createElement("tr");
                row.classList.add("hover:bg-gray-50");

                row.innerHTML = `
            <td class="px-4 py-3">
                <div class="flex items-center space-x-3">
                   <img src="http://localhost:3000/${product.images.length > 0 ? product.images[0] : 'uploads/default.jpg'}" 
                     alt="${product.productName}" class="w-20 h-20 object-cover rounded-lg border border-gray-300 shadow-md">
                    <div>
                        <p class="font-medium">${product.productName}</p>
                        <p class="text-sm text-gray-500">SKU: ${product._id.slice(-6)}</p>
                    </div>
                </div>
            </td>
            <td class="px-4 py-3">${product.category}</td>
            <td class="px-4 py-3">
                <span class="px-2 py-1 bg-${product.stock > 10 ? 'green' : 'red'}-100 text-${product.stock > 10 ? 'green' : 'red'}-800 rounded-full text-sm">
                    ${product.stock > 0 ? `In Stock (${product.stock})` : "Out of Stock"}
                </span>
            </td>
            <td class="px-4 py-3 text-right">$${product.price}</td>
            <td class="px-4 py-3 flex justify-center space-x-2">
            <button class="p-2 hover:bg-gray-100 rounded-lg" onclick='openEditModal(${JSON.stringify(product)})'>
                 <span class="material-symbols-outlined">edit</span>
            </button>

            <button class="p-2 hover:bg-gray-100 rounded-lg text-red-500" onclick="deleteProduct('${product._id}')">
                    <span class="material-symbols-outlined">delete</span>
             </button>

            </td>
        `;

                tbody.appendChild(row);
            });
        }

    </script> -->
</body>
<script src="../../../productmanage.js"></script>
</html>